<!-- today_word/templates/today_word/create_new_word.html -->
{% extends 'blog/base_full_width.html' %}

{% block main_area %}
<h2>Create New Word</h2>
<hr/>
<form method="post" action="{% url 'word_create' %}">
    {% csrf_token %}
    <label for="id_title">Title*</label>
    <input type="text" id="id_title" name="title" class="form-control" required>

    <button type="button" id="generate-content-btn" class="btn btn-primary mt-2">Generate Content</button>

    <label for="id_content" class="mt-4">Content*</label>
    <textarea id="id_content" name="content" rows="10" class="form-control" required></textarea>

    <button type="submit" class="btn btn-success mt-3">Submit</button>
</form>

<script>



document.getElementById("generate-content-btn").addEventListener("click", function() {
    const title = document.getElementById("id_title").value;
    const csrftoken = '{{ csrf_token }}';

    
    if (!title) {
        alert("Please enter a title first.");
        return;
    }

    fetch("./generate_content/", {
        method: "POST",
        headers: {
            "X-CSRFToken": csrftoken,
            "Content-Type": "application/x-www-form-urlencoded",
        },
        body: new URLSearchParams({title: title})
    })
    .then(response => response.json())
    .then(data => {
        if (data.content) {
            document.getElementById("id_content").value = data.content;
        } else if (data.error) {
            alert(data.error);
        }
    })
    .catch(error => console.error("Error:", error));
});
</script>
{% endblock %}